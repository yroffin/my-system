[
    {
        "name": "Each listener must have a label with @reference or different label and is an alias",
        "sets": [
            "element[type='node' and data.tag='listener' and (data.alias ? 'empty' : 'full') = 'full']"
        ],
        "asserts": [
            "(data.id ~> /(([a-z]*[A-Z]*[-!/ ]*[0-9]*)*[@]([a-z]*[A-Z]*[-!/ ]*[0-9]*)*)/i).match = data.id"
        ]
    },
    {
        "name": "Each alias listener must have a label terminating by @",
        "sets": [
            "element[type='node' and data.tag='listener' and data.alias!='']"
        ],
        "asserts": [
            "(data.id ~> /(([a-z]*[A-Z]*[-!/ ]*[0-9]*)*[@]([a-z]*[A-Z]*[-!/ ]*[0-9]*)*)/i).match = data.id"
        ]
    },
    {
        "name": "All edge targeting a listener must have a label 'provide' or 'ClientId: *",
        "sets": [
            "element[type='edges' and data.target.tag='listener']"
        ],
        "asserts": [
            "data.label = 'provide'",
            "data.label ~> /ClientID: ([a-z]*[A-Z]*[-!]*[0-9]*)*/i"
        ]
    }
]